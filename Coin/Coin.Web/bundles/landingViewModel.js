function marketSummaryEntry(n){var t=this,i;t.marketName="";t.baseCurrency="";t.marketCurrency="";t.marketCurrencyName="";t.title="";t.keywords="";t.prevDay=ko.observable(0);t.last=ko.observable(0).extend({calculateDelta:""});t.ask=ko.observable(0).extend({calculateDelta:""});t.bid=ko.observable(0).extend({calculateDelta:""});t.spread=ko.observable(0).extend({calculateDelta:""});t.high=ko.observable(0).extend({calculateDelta:""});t.low=ko.observable(0).extend({calculateDelta:""});t.baseVolume=ko.observable(0).extend({calculateDelta:""});t.marketVolume=ko.observable(0).extend({calculateDelta:""});t.change=ko.observable(0).extend({calculateDelta:""});t.isFiat=ko.pureComputed(function(){return t.baseCurrency=="USD"||t.baseCurrency=="CNY"||t.baseCurrency=="USDT"||t.baseCurrency=="BITCNY"});t.isActive=ko.observable(!1);t.isVerified=ko.observable(!1);t.created=ko.observable(new moment);t.lastUpdated=ko.observable(new moment);t.isEven=ko.observable(!1);t.imgPath="";t.urlPath="";t.isSponsored=ko.observable(!1);i=function(){return t.isFiat()?2:8};t.displayLast=ko.pureComputed(function(){return t.last().toFixed(i())},this);t.displayAsk=ko.pureComputed(function(){return t.ask().toFixed(i())},this);t.displayBid=ko.pureComputed(function(){return t.bid().toFixed(i())},this);t.displayLastUpdated=ko.pureComputed(function(){return t.lastUpdated().format("MM/DD/YYYY hh:mm:ss A")},this);t.displaySpread=ko.pureComputed(function(){return t.spread().toFixed(1)+"%"},this);t.displayHigh=ko.pureComputed(function(){return t.high().toFixed(i())},this);t.displayLow=ko.pureComputed(function(){return t.low().toFixed(i())},this);t.displayBaseVolume=ko.pureComputed(function(){return t.baseVolume().toFixed(2)},this);t.displayMarketVolume=ko.pureComputed(function(){return t.marketVolume().toFixed(2)},this);t.displayChange=ko.pureComputed(function(){return t.change().toFixed(1)+"%"},this);t.dispose=function(){for(var n in t)t.hasOwnProperty(n)&&ko.isComputed(t[n])&&t[n].dispose()};t.update=function(n){t.updateSummary(n.Summary);t.marketCurrencyName=n.Market.MarketCurrencyLong;t.title=t.marketCurrencyName+" ("+t.marketCurrency+")";t.keywords=t.marketCurrencyName+" "+t.marketCurrency;t.created(new moment(n.Market.Created?n.Market.Created+" Z":0));t.lastUpdated(new moment);t.isActive(n.Market?n.Market.IsActive:!1);t.isVerified(n.IsVerified?n.IsVerified:!1);t.isSponsored(n.Market?n.Market.IsSponsored:!1);t.imgPath=n.Market.LogoUrl?n.Market.LogoUrl:"/Content/img/symbols/"+t.marketCurrency+".png";t.urlPath="/Market/Index?MarketName="+t.marketName};t.updateSummary=function(n){t.marketName=n.MarketName;dash=t.marketName?t.marketName.indexOf("-"):0;t.baseCurrency=t.marketName?t.marketName.substr(0,dash):"";t.marketCurrency=t.marketName?t.marketName.substr(dash+1):"";t.prevDay(n.PrevDay?n.PrevDay:0);t.last(n.Last?n.Last:0);t.ask(n.Ask?n.Ask:0);t.bid(n.Bid?n.Bid:0);t.high(n.High?n.High:0);t.low(n.Low?n.Low:0);t.spread(100*(t.ask()-t.bid())/t.ask());t.baseVolume(n.BaseVolume?n.BaseVolume:0);t.marketVolume(n.Volume?n.Volume:0);t.change(t.prevDay()?(t.last()-t.prevDay())/t.prevDay()*100:0)};t.update(n)}function marketSummaryTable(n,t){var i=this,r,u,f;i.summaries=ko.observableArray([]).indexed("marketName");i.filteredSummaries=ko.pureComputed(function(){var r=i.summaries(),f,e;if(t.orderBy){var n=t.orderBy,u;u=function(t,i){return t[n]()<i[n]()?-1:t[n]()>i[n]()?1:t[n]()==i[n]()?0:0};f=function(n,t){return u(t,n)};n=="created"&&(u=function(n,t){return n.created().isBefore(t.created())?-1:n.created().isAfter(t.created())?1:n.created().isSame(t.created())?0:0});e=f;r=r.sort(e)}return t.maxRows&&(r=r.slice(0,t.maxRows)),r});i.topMarket=ko.observable();i.options=t;u=function(n){for(var u,r=n.serviceData.Deltas,t=0;t<r.length;t++)r[t].marketName=r[t].MarketName,i.summaries.contains(r[t])&&(u=i.summaries.index()[r[t].MarketName],i.summaries()[u].updateSummary(r[t]));i.summaries.valueHasMutated()};f=function(n){var r=n.serviceData,u=$.map(r,function(n){var i=new marketSummaryEntry(n),r;if(i.isActive()||(i.marketVolume(0),i.baseVolume(0)),t.baseCurrency)if(i.marketName.lastIndexOf(t.baseCurrency,0)===0)i=i;else return null;return t.newMarketsOnly?(r=moment().diff(moment(i.created()),"days"),r<=7?i:null):t.verifiedOnly?(r=moment().diff(moment(i.created()),"days"),i.isVerified()&&r>=120?i:null):t.fiatOnly?i.isFiat()?i:null:i});i.summaries(u)};$("#event-store").on("data-update-summaries",u);$("#event-store").one("data-query-summaries",f);i.resize=function(n){r.marketSummaryDataTable("resize",n)};n&&(r=$("#"+n).marketSummaryDataTable({dataSource:i.summaries,customToolbar:t.customToolbar}))}$(function(){"use strict";function n(n){function w(){u()&&(!n||n.isAuthenticated)&&(r&&i.server.queryOrderState(r).done(function(n){t("server.queryOrderState");t(n);n&&s("data-query-orders",n)}),ut())}function ut(){if(u()){var t="/Api/v2.0/auth/orders/GetOrderHistory",i={};(!n||n.isAuthenticated)&&(n&&n.version&&n.version.needsUpdate||(r&&(t="/Api/v2.0/auth/market/GetOrderHistory",i.MarketName=r),jQuery.ajax({url:t,type:"POST",contentType:"application/x-www-form-urlencoded",dataType:"json",data:i,success:function(n){n.success&&s("data-query-closedOrders",n.result)},error:function(){console.log("Error loading order history ...")}})))}}function ft(){u()&&i.server.queryBalanceState().done(function(n){t("server.queryBalanceState");t(n);n&&s("data-query-balances",n)})}function b(){u()&&(l||(l=!0,i.server.queryExchangeState(r).done(function(n){t("server.queryExchangeState().done()");t(n);n&&p&&s("data-query-exchange-"+r,n);l=!1})))}function et(){n&&n.version&&n.version.needsUpdate||jQuery.ajax({url:"/api/v2.0/pub/Markets/GetMarketSummaries",dataType:"json",cache:!1,success:function(n){n.success?s("data-query-summaries",n.result):console.log(n.message)},error:function(){console.log("Error loading market summaries ...")}})}function o(n,t){$("#event-store").trigger({type:n,serviceData:t})}function s(n,t){$("#event-store").trigger({type:n,serviceData:t})}function ot(){return _.debounce(w,rt),!1}function st(){return b(),!1}var h=n&&n.isAuthenticated,r=n.market&&n.market.marketName?n.market.marketName:null,v=n.market&&n.market.marketName&&n.market.fetchExchange,y=n.fetchFlood,u=ko.observable(!1),f=ko.observable("Disconnected"),i=$.connection.coreHub,c=window.location.href;c.indexOf("beta.bittrex.com")>-1?$.connection.hub.url="https://socket-beta.bittrex.com/signalr":c.indexOf("stage.bittrex.com")>-1?$.connection.hub.url="https://socket-stage.bittrex.com/signalr":c.indexOf("bittrex.com")>-1&&($.connection.hub.url="https://socket.bittrex.com/signalr");var p=!0,nt=!1,tt=!1,it=!1,rt=5e3,l=!1,e=function(){tt&&(console.log("hub.client"),console.log(i))},t=function(n){it&&console.log(n)};i.client.updateOrderState=function(n){e();t("client.updateOrderState");t(n);n&&o("data-update-orders",n)};i.client.updateSummaryState=function(n){e();t("client.updateSummaryState");t(n);n&&n.Deltas&&o("data-update-summaries",n)};i.client.updateBalanceState=function(n){e();t("client.balanceStateDelta");t(n);n&&o("data-update-balances",n)};i.client.updateExchangeState=function(n){e();t("client.updateExchangeState");t(n);n&&p&&o("data-update-exchange-"+r,n)};i.client.updateFloodState=function(n){e();t("client.updateFloodState");t(n);n&&nt&&o("data-update-flood",n)};$("#event-store").on("request-query-orders",ot);$("#event-store").on("request-query-exchange-"+r,st);var k=function k(){console.log("socketDataProvider.subscribeUser (start) ");h&&i.server.subscribeToUserDeltas().done(function(n){console.log("server.subscribeToUserDeltas (done)");n?(w(),ft()):h=!1}).fail(function(){console.log("socketDataProvider.subscribeToUserDeltas (failed): "+r);$.connection.hub.lastError&&console.log("socketDataProvider.subscribeToUserDeltas (failed): "+$.connection.hub.lastError.message);setTimeout(function(){k()},5e3)})},a=function a(){console.log("socketDataProvider.subscribeMarket (start): "+r);r&&v&&i.server.subscribeToExchangeDeltas(r).done(function(n){console.log("server.subscribeToExchangeDeltas (done) ");n?b():a()}).fail(function(){console.log("socketDataProvider.subscribeToExchangeDeltas (failed): "+r);$.connection.hub.lastError&&console.log("socketDataProvider.subscribeToExchangeDeltas (failed): "+$.connection.hub.lastError.message);a()})},d=function d(){console.log("socketDataProvider.subscribeFlood (start) ");y&&i.server.subscribeToFloodDeltas().done(function(){console.log("server.subscribeToFloodDeltas (done)")}).fail(function(){console.log("socketDataProvider.subscribeToFloodDeltas (failed) ");$.connection.hub.lastError&&console.log("socketDataProvider.subscribeToFloodDeltas (failed): "+$.connection.hub.lastError.message);d()})},g=function(){console.log("websocket ready");f("Connected");$("#event-store").trigger({type:"socket-start"});h&&k();v&&a();y&&d();et();u(!0)};$.connection.hub.start().done(g);i.client.stopClient=function(){$.connection.hub.stop()};i.client.refresh=function(){market.server.refresh()};$.connection.hub.connectionSlow(function(){console.log("websocket slow");f("Slow");$("#event-store").trigger({type:"socket-slow"})});$.connection.hub.reconnecting(function(){console.log("websocket reconnecting");f("Reconnecting");$("#event-store").trigger({type:"socket-reconnecting"})});$.connection.hub.reconnected(function(){console.log("websocket reconnected");f("Connected");$("#event-store").trigger({type:"socket-connected"})});$.connection.hub.disconnected(function(){console.log("websocket disconnected");f("Disconnected");$("#event-store").trigger({type:"socket-disconnected"});u(!1);setTimeout(function(){$.connection.hub.start().done(g);console.log("reconnect websockets")},5e3)})}n(bittrex)});$(function(){"use strict";function n(n){function i(){if(bittrex&&bittrex.version&&bittrex.version.needsUpdate){f();return}jQuery.ajax({url:"/api/v2.0/pub/Markets/GetMarketSummaries",dataType:"json",cache:!1,success:function(n){n.success?r(n.result):console.log(n.message)}})}function r(n){$("#event-store").trigger({type:"data-query-summaries",serviceData:n})}function u(n){t!==null&&clearInterval(t);t=setInterval(function(){i()},n)}function f(){t!==null&&clearInterval(t)}var t=null;i();u(n)}n(3e4)});$(function(){"use strict";var n,t,i;$("a.page-scroll").bind("click",function(n){var t=$(this);$("html, body").stop().animate({scrollTop:$(t.attr("href")).offset().top-50},1250,"easeInOutExpo");n.preventDefault()});$("body").scrollspy({target:".navbar-fixed-top",offset:51});$(".navbar-collapse ul li a").click(function(){$(".navbar-toggle:visible").click()});$("h1").fitText(1.2,{minFontSize:"35px",maxFontSize:"65px"});$("#mainNav").affix({offset:{top:100}});n="ontouchstart"in document.documentElement;n||(t=new WOW({offset:50}),t.init());i=new marketSummaryTable(null,{maxRows:5,customToolbar:"market-toolbar-all",verifiedOnly:!0,orderBy:"baseVolume"});document.getElementById("market-summary-table")!=null&&ko.applyBindings(i,document.getElementById("market-summary-table"))})